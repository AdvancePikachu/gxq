<template>
	<Layout>
		<Content>
			<Breadcrumb>
				<BreadcrumbItem>培训管理</BreadcrumbItem>
				<BreadcrumbItem>培训课程管理</BreadcrumbItem>
			</Breadcrumb>
			<Card>
				<Row>
					<Col span="6">
					    <Tree :data="ztreeData" :render="renderContent"></Tree>
					</Col>
					<Col span="16">
                    <h3>培训信息</h3>
					<Form ref="formValidate" :model="formValidate" :rules="ruleValidate" :label-width="100">
						<FormItem label="培训类别：">
							<Row>
								<Col span="24">
								    <Input disabled></Input>
								</Col>
							</Row>
						</FormItem>
            <FormItem label="培训名称：">
							<Row>
								<Col span="24">
								    <Input disabled></Input>
								</Col>
							</Row>
						</FormItem>
            <FormItem label="培训内容：">
							<Row>
								<Col span="24">
								    <Input disabled type="textarea" :autosize="{minRows: 3,maxRows: 5}"></Input>
								</Col>
							</Row>
						</FormItem>
					</Form>
					</Col>
				</Row>
			</Card>
		</Content>
	</Layout>
</template>

<script>
	export default {
		data() {
			return {
				formValidate: {},
				ruleValidate: {},
				defaultMsg: '',
				config: {
					initialFrameWidth: null,
					initialFrameHeight: 350
				},
				displayType: "inline-block",
				ztreeData: [{
					title: '硬件运维服务',
					expand: true,
					displayType: 'none',
					rootNode: 'none',
					children: [{
							title: '网络运维服务',
							expand: true,
							displayType: 'none',
							children: [{
									title: '例行操作',
									expand: true,
									displayType: 'none',
								},
								{
									title: '网络设备巡检服务',
									expand: true,
									displayType: 'none',
								}
							]
						},
						{
							title: '主机运维服务',
							expand: true,
							displayType: 'none',
							children: [{
									title: '响应支持',
									expand: true,
									displayType: 'none',
								},
								{
									title: '网络设备性能评估',
									expand: true,
									displayType: 'none',
								}
							]
						}
					]
				}],
				buttonProps: {
					type: 'ghost',
					size: 'small',
				}
			}
		},
		methods: {
			init() {

			},
			renderContent(h, {
				root,
				node,
				data
			}) {
				return h('span', {
					on: {
						mouseenter: (e) => {
							this.mouseenterNode(root, node, data);
						},
						mouseleave: (e) => {
							this.mouseleaveNode(root, node, data);
						},
					},
					style: {
						display: 'inline-block',
						width: '100%'
					}
				}, [
					h('span', [
						h('Icon', {
							props: {},
							style: {
								marginRight: '8px'
							}
						}),
						h('span',{
							style: {
								display: 'inline-block',
							    height: '24px',
							    float: 'left',
							    lineHeight: '24px'
							}
						}, data.title)
					]),
					h('span', {
						style: {
							display: 'inline-block',
							marginLeft: '10px',
							display: data.displayType
						}
					}, [
						h('Button', {
							props: Object.assign({}, this.buttonProps, {
								icon: 'plus'
							}),
							style: {
								marginRight: '8px',
								color: 'green'
							},
							on: {
								click: () => {
									this.append(data)
								}
							}
						}),
						h('Button', {
							props: Object.assign({}, this.buttonProps, {
								icon: 'edit'
							}),
							style: {
								marginRight: '8px',
								color: 'blue'
							},
							on: {
								click: () => {
									this.append(data)
								}
							}
						}),
						h('Button', {
							props: Object.assign({}, this.buttonProps, {
								icon: 'close'
							}),
							style: {
								marginRight: '8px',
								color: 'red',
								display: data.rootNode||"inline-block"
							},
							on: {
								click: () => {
									this.remove(root, node, data)
								}
							}
						})
					])
				]);
			},
			append(data) {
				const children = data.children || [];
				children.push({
					title: 'appended node',
					expand: true
				});
				this.$set(data, 'children', children);
			},
			remove(root, node, data) {
				const parentKey = root.find(el => el === node).parent;
				const parent = root.find(el => el.nodeKey === parentKey).node;
				const index = parent.children.indexOf(data);
				parent.children.splice(index, 1);
			},
			mouseenterNode(root, node, data) {
				data.displayType='inline-block';
			},
			mouseleaveNode(root, node, data) {
				data.displayType='none';
			}
		},
		mounted() {
			this.$nextTick(() => {
				this.init();
			});

		}
	}
</script>

<style type="text/css" scoped>
	.w168 {
		width: 168px;
	}
</style>