<template>
	<div class="wAuto">
		<Layout>
			<Content>
				<Breadcrumb>
					<BreadcrumbItem>故障管理</BreadcrumbItem>
					<BreadcrumbItem>我的任务</BreadcrumbItem>
				</Breadcrumb>
				<Card>
					<Form ref="formValidate" inline :label-width="90">
						<FormItem label="故障类别">
							<Select >
								<Option value="0">全部</Option>
								<Option value="1">SA变更</Option>
								<Option value="2">硬件故障</Option>
								<Option value="3">业务程序故障</Option>
								<Option value="4">程序BUG</Option>
							</Select>
						</FormItem>
						<FormItem label="故障级别">
							<Select >
								<Option value="0">全部</Option>
								<Option value="1">一级</Option>
								<Option value="2">二级</Option>
								<Option value="3">三级</Option>
							</Select>
						</FormItem>
						<FormItem label="故障简述">
							<Input type="text" > </Input>
						</FormItem>
						<FormItem label="产生时间">
							<DatePicker class="queryTime" :value="queryTime" format="yyyy/MM/dd" type="daterange" placement="bottom-end" placeholder="请选择日期"></DatePicker>
						</FormItem>
						<br />
						<FormItem label="故障状态">
							<Select >
								<Option value="0">全部</Option>
								<Option value="1">处理中</Option>
								<Option value="2">已完结</Option>
							</Select>
						</FormItem>
						<FormItem label="系统名称">
							<Select >
								<Option value="0">全部</Option>
							</Select>
						</FormItem>
						<FormItem label="故障主机">
							<Input type="text" > </Input>
						</FormItem>
						<FormItem>
							<Button type="info">查询</Button>
						</FormItem>
					</Form>
					<Table border ref="selection" :columns="columns" :data="data"></Table>
					<div class="bottom-bar">
						<Page :total="100" show-sizer show-elevator></Page>
					</div>
				</Card>
			</Content>
			<Modal v-model="dealReport" title="故障处理" class-name="vertical-center-modal" width="60%">
				<deal-report ref="doccreate" v-on:examine="createSave"></deal-report>
				<div slot="footer">
					<Button type="info" @click="handleSubmit('doccreate')">确定</Button>
					<Button type="text" @click="closeDealReport">关闭</Button>
				</div>
			</Modal>
			<Modal v-model="modal" title="处理报告" class-name="vertical-center-modal" width="60%">
				<ledger-view></ledger-view>
				<div slot="footer">
					<Button type="text" @click="closeModal">关闭</Button>
				</div>
			</Modal>
		</Layout>></h3>
		
	</div>
</template>

<script>
	import ledgerView from './view'
	import dealReport from './dealReport'
	export default {
		data() {
			return {
				modal: false,
				dealReport: false,
				queryTime:['2018-06-01', '2018-07-01'],
				columns: [{
						type: 'index',
						width: 60,
						title: '序号',
						align: 'center'
					},
					{
						title: '故障类别',
						key: 's1'
					},
					{
						title: '故障级别',
						key: 's2'
					},
					{
						title: '故障简述',
						key: 's3'
					},
					{
						title: '系统名称',
						key: 's4'
					},
					{
						title: '故障主机',
						key: 's5'
					},
					{
						title: '故障状态',
						key: 's6'
					},
					{
						title: '产生时间',
						key: 's7'
					},
					{
						title: '处理意见',
						key: 's8'
					},
					{
						title: '处理报告',
						key: 's9'
					},
					{
						title: '操作',
						key: 'act',
						align: 'center',
						render: (h, params) => {
							if(params.row.s6=="已完结"){
								return h('div', [
									h('Button', {
										props: {
											type: 'primary',
											size: 'small'
										},
										on: {
											click: () => {
												this.modal = true;												
											}
										}
									}, '报告查看')
								]);
							}else{
								return h('div', [
									h('Button', {
										props: {
											type: 'primary',
											size: 'small'
										},
										on: {
											click: () => {
												this.dealReport = true;												
											}
										}
									}, '处理')
								]);
							}
						}
					},
				],
				data: [{
					s1: '',
					s2: '',
					s3: '',
					s4: '',
					s5: '',
					s6: '处理中',
					s7: '',
					s8: '',
					s9: '',
				}, {
					s1: '',
					s2: '',
					s3: '',
					s4: '',
					s5: '',
					s6: '处理中',
					s7: '',
					s8: '',
					s9: '',
				}, {
					s1: '',
					s2: '',
					s3: '',
					s4: '',
					s5: '',
					s6: '已完结',
					s7: '',
					s8: '',
					s9: '',
				}, {
					s1: '',
					s2: '',
					s3: '',
					s4: '',
					s5: '',
					s6: '处理中',
					s7: '',
					s8: '',
					s9: '',
				}, {
					s1: '',
					s2: '',
					s3: '',
					s4: '',
					s5: '',
					s6: '已完结',
					s7: '',
					s8: '',
					s9: '',
				}]
			}
		},
		components:{
			ledgerView,dealReport
		},
		methods: {
			closeModal(){
				this.modal = false;
			},
			closeDealReport(){
				this.dealReport = false;
			},
			handleSubmit(name) {
				this.$refs[name].handleSubmit("docData");
			},
			createSave(param) {
				console.log(param);
				this.createState = false;
			},
		}
	}
</script>

<style type="text/css" scoped>
.wAuto{
	width: 100%;
}
.queryTime{
	width: 230px;
}
.flow{
	margin-top: 20px ;
}
</style>