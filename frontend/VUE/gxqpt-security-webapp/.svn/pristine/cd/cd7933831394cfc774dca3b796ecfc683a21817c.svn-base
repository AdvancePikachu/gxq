<template>
  <Layout>
    <Content>
      <Breadcrumb>
        <BreadcrumbItem>培训管理</BreadcrumbItem>
        <BreadcrumbItem>培训课程目录</BreadcrumbItem>
      </Breadcrumb>
      <Card>
        <Form
          ref="formValidate"
          inline
          :label-width="100"
          :model="trainCourse">

            <FormItem label="培训类别">
                <Select v-model="trainCourse.type" style="width:200px">
                    <Option value="类别1">类别1</Option>
                    <Option value="类别2">类别2</Option>
                    <Option value="类别3">类别3</Option>
                </Select>
            </FormItem>
            <FormItem label="培训名称">
                <Select v-model="trainCourse.name" style="width:200px">
                    <Option value="名称1">名称1</Option>
                    <Option value="名称2">名称2</Option>
                    <Option value="名称3">名称3</Option>
                </Select>
            </FormItem>
            <FormItem label="培训内容：">
                <Input
                type="text"
                v-model="trainCourse.content">
                </Input>
            </FormItem>
          <FormItem>
            <Button type="primary" @click="search">查询</Button>
          </FormItem>
        </Form>
        <Form>
            <FormItem>
                <Button type="primary" size="large" @click="exportAllData()"><Icon type="ios-download-outline"></Icon> 导出全部数据</Button>
                <Button type="primary" size="large" @click="exportPageData()"><Icon type="ios-download-outline"></Icon> 导出本页数据</Button>
                <Button type="primary" size="large" @click="exportCustomData()"><Icon type="ios-download-outline"></Icon> 自定义导出</Button>
                <Button type="primary" size="large" @click="trainDetailBtn()"><Icon type="ios-download-outline"></Icon> 培训申请</Button>
                <!-- <router-link to="/trainList">
                    <Button>培训申请</Button>
                </router-link> -->
            </FormItem>
        </Form>
        <Table border ref="thisTable" :columns="tableList.columns" :data="tableList.data"></Table>
        <div class="bottom-bar">
            <Page :total="100" show-sizer show-elevator></Page>
        </div>
      </Card>
    </Content>
    <customTableModal @checkData="getCheckData" :listScreen='tableList.columns' :evalModal='customTable' :closeModal='closeCustomTable'></customTableModal>
    <trainDetailModal :evalModal='trainDetail' :closeModal='closeTrainDetail'></trainDetailModal>
  </Layout>
</template>

<script>
import customTableModal from "./trainModal/customTableModal.vue";
import trainDetailModal from "./trainModal/trainDetailModal.vue";
export default {
    components: {
        customTableModal,
        trainDetailModal
    },
  data () {
    return {
      trainDetail: false,
      customTable:false,
      trainCourse: {
        type:"",
        content: '',
        name: ''
      },
      tableList: {
        columns: [{
          type: 'index',
          title: '序号',
          width: 60,
          align: 'center'
        },
        {
          title: '培训类别',
          key: 'type'
        },
        {
          title: '培训名称',
          key: 'name'
        },
        {
          title: '培训内容',
          key: 'content'
        },{
                title: '操作',
                type: 'act',
                width: 200,
                align: 'center',
                render: (h, params) => {
                    return h('div', [
                        h('Button', {
                            props: {
                                type: 'primary',
                                size: 'small'
                            },
                            style: {
                                marginRight: '5px'
                            },
                            on: {
                                click: () => {
                                    this.trainDetail = true;
                                }
                            }
                        }, '培训申请')
                    ]);
                }
            }],
        data: [
          {
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          },{
            type: '硬件运维服务',
            name: '网络运维服务',
            content: '例行操作',
          }
        ]
      },
    }
  },
  methods: {
    search () {
      alert()
    },
    exportAllData(){//导出全部数据

    },
    exportPageData(){//导出本页数据
        this.$refs.thisTable.exportCsv({
            filename: 'table'
        });
    },
    exportCustomData(){//自定义导出
        this.customTable = true;
        console.log("自定义导出");
    },
    closeCustomTable(){
        this.customTable = false;
    },
    closeTrainDetail(){
      this.trainDetail = false;
    },
    trainDetailBtn(){
      this.trainDetail = true;
    },
    getCheckData(data){//获取选择的列名
        var arr = [];
        for(var i =0;i<this.tableList.columns.length;i++){//筛选匹配正确的列名单
            for(var j in data){
                if(this.tableList.columns[i].title==data[j]){
                    arr.push(this.tableList.columns[i]);
                }
            }
        }
        if(arr.length!=0){
            this.$refs.thisTable.exportCsv({
                filename: 'table',
                columns:arr,
                data: this.tableList.data
            });
        }else{
            console.log("选项不能为空!")
        }
        this.customTable = false;
    }
  }
}
</script>

<style lang='less'>
.access-list{
  span.handle{
    margin: 0 5px;
    display: inline-block;
  }
}
</style>
